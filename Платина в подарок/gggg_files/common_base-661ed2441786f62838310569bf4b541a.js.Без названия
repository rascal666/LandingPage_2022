function getNoun(e,t){return e=Math.abs(e),(e%=100)>=5&&e<=20?t[2]:(e%=10,1===e?t[0]:e>=2&&e<=4?t[1]:t[2])}function setCookie(e,t,n,r,o,a){if(!e||!t===undefined)return!1;var i=e+"="+encodeURIComponent(t);return n&&(i+="; expires="+n.toGMTString()),r&&(i+="; path="+r),o&&(i+="; domain="+o),a&&(i+="; secure"),document.cookie=i,!0}function getCookie(e){var t="(?:; )?"+e+"=([^;]*);?";return!!new RegExp(t).test(document.cookie)&&decodeURIComponent(RegExp.$1)}function deleteCookie(e){return setCookie(e,null,new Date(0),"/")}function paginateRender(){$(".js-pagination-list").each(function(e){var t,n=$(this);n.attr("id",n.attr("id")+e),t=this.id.substr(19),Paginate.get(t).init({cur:n.data("current-page"),length:n.data("pages"),itemWidth:43,sliderMinWidth:100})})}Comparison=function(e){function t(e){var t,n,r=0;for(t in e)for(n in e[t])r+=e[t][n].length;return r}function n(n,r,o){IStorage.get(v.keyStorage,function(a){var i,s=JSON.parse(a||"{}");if(!r){if(t(s)>=v.limit)return l(o,v.messageLimit,v.urlRender,!0),$doc.trigger("limitReached:coreComparison"),!1;if(s[n.rubric]&&t({rubric:s[n.rubric]})>=v.limitForRubric)return l(o,v.messageLimitForRubric,v.urlRender+(o.data("joined-path")||""),!0),$doc.trigger("limitForRubricReached:coreComparison"),!1}s[n.rubric]||r||(s[n.rubric]={}),r?(s[n.rubric]&&s[n.rubric][n.region].length&&-1!==(i=e.inArray(n.id,s[n.rubric][n.region]))&&(s[n.rubric][n.region].splice(i,1),s[n.rubric][n.region].length||delete s[n.rubric][n.region],Object.keys(s[n.rubric]).length||delete s[n.rubric]),$doc.trigger("delete-product-success:comparison",[o])):(s[n.rubric][n.region]||(s[n.rubric][n.region]=[]),~e.inArray(n.id,s[n.rubric][n.region])||s[n.rubric][n.region].push(n.id)),IStorage.set(v.keyStorage,JSON.stringify(s)),$doc.trigger("change-product:comparison",[n.id,t(s),r])})}function r(t,n,r){e.ajax({url:v.urlChangeProduct,type:"post",data:{product_id:t.id,region_id:t.region,_method:n?"DELETE":""},dataType:"json",success:function(e){"total_filled"===e.message?(l(r,v.messageLimit,v.urlRender,!0),$doc.trigger("limitReached:coreComparison")):"rubric_filled"===e.message?(l(r,v.messageLimitForRubric,v.urlRender+(r.data("joined-path")||""),!0),$doc.trigger("limitForRubricReached:coreComparison")):$doc.trigger("change-product:comparison",[t.id,e.count||0,n]),n&&$doc.trigger("delete-product-success:comparison",[r])},error:function(e,t,n){console.log(e,t,n)}})}function o(e,t,o){v.authorized?r(e,t,o):(n(e,t,o),t||a(e))}function a(t){e.ajax({url:v.urlHitStatistics,type:"post",data:{product_id:t.id,region_id:t.region},dataType:"json"})}function i(e,t){o(e,!0,t)}function s(n){v.authorized?e.ajax({url:v.urlClearRubric,type:"post",data:{rubric_id:n},dataType:"json",success:function(e){$doc.trigger("change-product:comparison",[null,e.count]),$doc.trigger("delete-rubric-success:comparison")}}):IStorage.get(v.keyStorage,function(e){var r=JSON.parse(e||"{}");delete r[n],IStorage.set(v.keyStorage,JSON.stringify(r)),$doc.trigger("change-product:comparison",[null,t(r)]),$doc.trigger("delete-rubric-success:comparison")})}function c(t,n){return e("<a>").addClass("compare-link js-compare-link").attr({href:v.urlRender+(t.data("joined-path")||""),target:"_blank"}).text(t.closest(".js-comparison-block").data("linkParams").text.replace("%count%",n))}function u(){$doc.on("change",".js-comparison-checkbox",function(){var t=e(this),n=t.closest(".js-comparison-block"),r=n.parent().toggleClass("tools-links__item_active").find(".js-add-to-comparison"),a=r.data();n.toggleClass("tools-links__item-content_active"),o({id:a.productId,rubric:a.rubricL4Id,region:a.regionId},r.hasClass(v.classRemove),r)}),e("body").on("click touchstart",function(){e(".js-comparison-add-lightbox").remove()}),$win.resize(function(){e(".js-comparison-add-lightbox").remove()}),$doc.on("changeWidth",function(){e(".js-comparison-add-lightbox").remove()}),$doc.on("change-product:comparison",function(t,n,r,o){var a,i,r,s=null,u=e(".js-total-compare-count-link");n&&(s=e('.js-add-to-comparison[data-product-id="'+n+'"]'),a=s.closest(".js-comparison-block"),s.toggleClass(v.classRemove),a.find(".js-comparison-checkbox").prop({checked:!o}),i=a.find(".js-add-to-comparison").data("gaEventType"),a.attr("title")!==undefined&&a.attr({title:s.hasClass("js-remove-comparison")?s.data("remove-title"):s.data("add-title")}),s.closest("[data-without-popup]").length||o||!r?(h(s),o&&r&&$doc.trigger("addToComparison:coreComparison",["remove",i])):(h(s),l(s,r+" "+getNoun(r,["\u0442\u043e\u0432\u0430\u0440","\u0442\u043e\u0432\u0430\u0440\u0430","\u0442\u043e\u0432\u0430\u0440\u043e\u0432"])+" \u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438",v.urlRender+(s.data("joined-path")||"")),$doc.trigger("addToComparison:coreComparison",["add",i])),a.data("linkParams")&&(r=r||a.data("linkParams").count,!a.find(".js-compare-link").toggle(!o).length&&a.append(c(s,r)),a.find(".js-add-to-comparison").toggle(o),h(s))),r!==undefined&&(0!==r?(u.removeClass("empty"),v.rubric&&u.attr("href",v.urlRender+v.rubric.joined_path)):u.addClass("empty").attr("href",v.urlRender),u.find(".toolbar-count").text(r).addClass("attention"),clearTimeout(m),m=setTimeout(function(){u.find(".toolbar-count").removeClass("attention")},1e4))}),$doc.on("ajax-toolbar-complete",function(){v.authorized||IStorage.get(v.keyStorage,function(n){var r=JSON.parse(n||"{}"),o=e(".js-total-compare-count-link"),a=t(r);a>0&&o.removeClass("empty").find(".toolbar-count").text(a),v.rubric&&r[v.rubric.id]&&o.attr("href",v.urlRender+v.rubric.joined_path)})}),b=!0}function l(t,n,r,o){var a=t.closest(".js-comparison-block"),i=a.closest(a.data("popup-parent")),s=i.length?t.position():t.offset(),c=e("<div>").addClass(v.classLightbox+" js-comparison-add-lightbox"),u=e("<div>").addClass(v.classLightboxArrow),l=e(".js-base-width").offset();t=a.data("is-hidden-checkbox")?a:t,i=i.length?i:e("body"),i.append(c.append(u,e("<p>").addClass(v.classLightboxHint).toggleClass(v.classLightboxError,!!o).text(n),e("<a>").addClass(v.classLightboxAnchor).attr("href",r).text(o?"\u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044e":"\u0421\u0440\u0430\u0432\u043d\u0438\u0442\u044c").click(function(){e(".js-comparison-add-lightbox").remove()}))),c.css({top:s.top+t.outerHeight()+10,left:s.left+t.outerWidth()/2-c.outerWidth()/2}),popupOffset=e(".js-comparison-add-lightbox").offset(),popupOffset.left<l.left&&(marginLeft=l.left-popupOffset.left,c.css({marginLeft:parseInt(c.css("marginLeft"))+marginLeft}),u.css({marginLeft:parseInt(u.css("marginLeft"))-marginLeft}))}function d(){IStorage.get(v.keyStorage,function(n){var r=JSON.parse(n||"{}");if(e.isEmptyObject(r))return!1;e.ajax({url:v.urlSynchronization,type:"post",data:{comparison_products_data:n},dataType:"json",success:function(e){$doc.trigger("change-product:comparison",[null,Math.min(e.count+t(r),v.limit)]),IStorage.set(v.keyStorage,"")},error:function(e,t,n){console&&console.log("\u041f\u0440\u0438 \u0441\u0438\u043d\u0445\u0440\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0435\u043c\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430",e,t,n)}})})}function p(t){IStorage.get(v.keyStorage,function(r){var o=JSON.parse(r||"{}");if(e.isEmptyObject(o))return location.href=v.urlRender,!1;e.ajax({url:v.urlRender+"/"+t,data:{comparison_products_data:r},dataType:"json",success:function(t){if(t.redirect_path)return location.href=t.redirect_path,!1;if(e(".js-comparison").html(t.body),$doc.trigger("insert-products:comparison"),t.deletedProducts)for(rubric in o)for(region in o[rubric])e.each(o[rubric][region],function(e,r){-1!==t.deletedProducts.indexOf(r)&&n({id:r,rubric:rubric,region:region},!0)})},error:function(e,t,n){console&&console.log("\u041f\u0440\u0438 \u0440\u0435\u043d\u0434\u0435\u0440\u0435 \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u0435\u043c\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430",e,t,n)}})})}function f(){IStorage.get(v.keyStorage,function(t){var n=JSON.parse(t||"{}"),r=Object.keys(n)[0];if(!r)return e(".js-comparison").append(e("<p>").addClass("comparison-message").text(v.messageEmpty)),!1;e.ajax({url:v.urlRedirect,data:{rubric_id:r},dataType:"html",success:function(e){location.href=v.urlRender+JSON.parse(e).path}})})}function g(){IStorage.get(v.keyStorage,function(t){var n,r,o=JSON.parse(t||"{}");if(o=e.extend(!0,o,v.checked),!Object.keys(o).length)return!1;for(n in o)for(r in o[n])e.each(o[n][r],function(e,t){$doc.trigger("change-product:comparison",[t])})})}function h(e){var t=e.closest(".js-comparison-block");t.hasClass("marked")?t.removeClass("marked").attr({title:t.data("add")}):t.addClass("marked").attr({title:t.data("remove")})}var m=null,b=!1,v={},y={authorized:!1,rubric:{},checked:{},keyStorage:"comparison-products",limit:999,limitForRubric:25,urlChangeProduct:"/dashboard/comparison",urlClearRubric:"/dashboard/comparison/clear",urlSynchronization:"/comparison/merge",urlRender:"/dashboard/comparison",urlRedirect:"/dashboard/compare/get_rubric_path",urlHitStatistics:"/dashboard/comparison/hit_statistics",classRemove:"remove-comparison js-remove-comparison",classLightbox:"comparison-popup",classLightboxHint:"cl-hint",classLightboxAnchor:"js-cl-anchor special-button grey-type fwn",classLightboxArrow:"cl-arrow js-cl-arrow",classLightboxError:"red",messageLimit:"\u0412\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432. \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0438\u0437 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f",messageLimitForRubric:"\u0412\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u043b\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0447\u0438\u0441\u043b\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u0440\u0443\u0431\u0440\u0438\u043a\u0435. \u0423\u0434\u0430\u043b\u0438\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u044b \u0438\u0437 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f",messageEmpty:"\u041d\u0435\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438."};return{init:function(t){v=e.extend(y,t),!b&&u(),g(),v.authorized&&d()},initEvents:function(t){v=e.extend(y,t),u()},render:p,redirect:f,check:g,removeProduct:i,removeRubric:s}}(jQuery),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var a,i,s=[];for(a in o)e.call(o,a)&&s.push(a);if(t)for(i=0;i<r;i++)e.call(o,n[i])&&s.push(n[i]);return s}}()),app.modules.flashMessage=app.modules.flashMessage||{},app.modules.flashMessage.load=function(){var e,t=$.parseJSON(getCookie("flash-message"));t&&$.each(t,function(t,n){if(n=n.replace(/\+/g," "),n=$("<div/>").html(n).text(),0!=$(".js-base-width .flash").length)deleteCookie("flash-message","/");else{try{$(".js-base-width").prepend($("<div>").addClass("flash").append($("<div>").addClass("flash-message "+t).append($("<p>").html(n)).append($("<i>").addClass("fa js-message-icon"))))}catch(e){}switch(e=$(".js-message-icon"),t){case"success":e.addClass("fa-check-circle");break;case"failure":e.addClass("fa-exclamation-circle");break;case"notice":e.addClass("fa-info-circle")}deleteCookie("flash-message","/")}})},Paginate=function(){var e={},t=function(e){var t=location.search.replace(/\&page=[\d]+/gi,"").replace(/\?page=[\d]+/gi,"?").replace(/\?\&/,"?"),n={length:10,cur:1,sliderMinWidth:50,itemWidth:43,tmpl_1st:location.pathname+("?"!=t?t:""),tmpl:"?page=#page#"},r=null,o=null,a=null,i=1,s=1,c=0,u=0,l=0,d=!1;""!=location.search.replace(/(^\?(?![^&]+)|&|\?)?page=[\d]+&?/,"")&&(n.tmpl=n.tmpl_1st+"&"+n.tmpl.substr(1));var p=function(){(c=r.width())&&(i=Math.floor(c/n.itemWidth),c=i*n.itemWidth,n.length>i?(u=i/n.length*c,u=Math.max(u,n.sliderMinWidth),s=n.cur+i<=n.length?n.cur:n.length-i+1,l=(s-1)/(n.length-i)*(c-u),g()):(h(),s=1,i=n.length),b(),m())},f=function(){var e="",t=r.closest(".js-b-pagination-wrapper").data("url-params")||{};return $.each(t,function(t,r){new RegExp(t+"=").test(n.tmpl)||(e+="&"+t+"="+r)}),e?n.tmpl+e:n.tmpl},g=function(){a.show(),l=l<0?0:l,l=l>c-u?c-u:l,o.width(u),o.css("left",l+"px"),r.removeClass(),r.addClass("b-pagination-list b-pagination-listBorderBottom")},h=function(){o.length&&(a.hide(),o.css("left","0")),r.removeClass(),r.addClass("b-pagination-list")},m=function(){var e=r.find("a");if(e.length)for(var t=0;t<e.length;t++)$(e[t]).attr("href",f().replace("#page#",$(e[t]).html()))},b=function(){for(var e=[],t=s;t<s+i;t++)e[e.length]=t==n.cur?'<li class="b-pagination-listItem b-pagination_listItemCurrent">'+t+"</li>":'<li class="b-pagination-listItem"><a href="#" class="b-pagination-listItemLink js-b-pagination-listItemLink">'+t+"</a></li>";r.html(e.join(""))},v=function(e){l=left0+w(e).x-x0,g();var t=Math.floor(l/(c-u)*(n.length-i)+1);t!=s&&(s=t,b())},x=function(e){var t=w(e).x-C(a).x;t-=u/2,t=t<0?0:t,l=t,left0=l,g();var r=Math.floor(l/(c-u)*(n.length-i)+1);r!=s&&(s=r,b(),m())},k=function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,!1},w=function(e){var t=y=0,n=document.documentElement;return"undefined"==typeof window.scrollX?(t=window.event.clientX+(n.scrollLeft?n.scrollLeft:document.body.scrollLeft),y=window.event.clientY+(n.scrollTop?n.scrollTop:document.body.scrollTop)):(t=e.clientX+window.scrollX,y=e.clientY+window.scrollY),{x:t,y:y}},C=function(e){var t=e.offset(),n=y=0;return n+=t.left,y+=t.top,{x:n,y:y}};return{init:function(t){if(r=$("#paginate-container-"+e),r.addClass("b-pagination-list"),$("#paginate-outer-"+e).length||(a=$("<div>"),a.attr("id","paginate-outer-"+e),a.addClass("b-pagination-outer"),r.after(a)),a=$("#paginate-outer-"+e),$("#paginate-slider-"+e).length||(o=$("<div>"),o.attr("id","paginate-slider-"+e),o.addClass("b-pagination-slider"),a.append(o)),o=$("#paginate-slider-"+e),!(r.length&&o.length&&a.length))throw"DOM-elements for page list are not found";if(t)for(var i in t)n[i]="undefined"!=typeof n[i]?t[i]:n[i];a.mousedown(function(e){return x(e),k(e)}),o.mousedown(function(e){return e=e||window.event,x0=w(e).x,left0=l,d=!0,k(e)}),$(document).mousemove(function(e){if(d)return v(e),k(e)}),$(document).mouseup(function(){d&&(m(),d=!1)}),$(window).resize(function(){p()}),p()}}};return{get:function(n){return"undefined"==typeof e[n]&&(e[n]=t(n)),e[n]}}}(),app.modules.paginate=app.modules.paginate||{},app.modules.paginate.load=function(){paginateRender()},function(e){var t={},n={markTag:"<em>",classMark:"mark-search-text",specSymbols:"<$#$>"},r=function(t,n){return e("<div>").append(e(n.markTag).addClass(n.classMark).html(t).first().clone()).html()},o=function(n){n.each(function(){var n=[],o=e(this).data("options",e.extend({},t)),a=o.data("options"),i=o.html(),s=new RegExp(a.specSymbols.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),"mgi"),c=i.replace(/<[^>]*>/gim,function(e){return n.push(e),a.specSymbols}),u=a.text.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&").replace(s,""),l=new RegExp(u+(u.split(" ").length>1?"|"+u.split(" ").join("|"):""),"mgi");c=c.replace(l,function(e){return e.length?r(e,a):e}).replace(/amp;/gi,""),c=c.replace(s,function(){return n.shift()}),o.html(c)})},a={init:function(r){if(!r||!r.text)return!1;e.extend(t,n,r),o(this)}};e.fn.findMark=function(t){return"string"==typeof t&&(t={text:t}),"object"!=typeof t&&t?a[t]?a[t].apply(this,Array.prototype.slice.call(arguments,1)):void e.error("\u041c\u0435\u0442\u043e\u0434 "+t+" \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 jQuery.findMark"):a.init.apply(this,arguments)}}(jQuery),function(e){var t={},n={url:"",pid:"",max:0,value:0,text:"",form:"progress",interval:1e3,disabled:!1,typeRequest:"GET",waitRequestComplete:!0,classProgressBar:"progress-bar",classProgressBarLabel:"progress-bar-label",classProgressBarContainer:"progress-bar-container"},r=function(e){return e.data("options")},o=function(t,n,r){var o={};o[n]=r,t.data("options",e.extend(t.data("options"),o))},a=function(e){var t=r(e);t.intervalId||(c(e),t.intervalId=setInterval(function(){t.request&&t.waitRequestComplete||c(e)},t.interval),o(e,"intervalId",t.intervalId),t.onEnable&&t.onEnable())},i=function(e){var t=r(e);clearInterval(t.intervalId),o(e,"intervalId",0),t.onDisable&&t.onDisable()},s=function(t){var n=r(t),o=e("<div>").addClass(n.classProgressBar),a=e("<div>").addClass(n.classProgressBarLabel).html(n.text);switch(n.form){case"progress":o.width(n.value/n.max*t.width()),t.empty().append(o,a);break;case"load":o.width(t.width()),t.empty().append(o,a)}},c=function(t){var n=r(t),a=n.url,c="";o(t,"request",!0),/\?/gi.test(a)&&(c=a.match(/\?.*/gi)[0],a=a.replace(/\?.*/gi,"")),e.ajax({url:a+(n.pid?"/"+n.pid+c:c),type:n.typeRequest,dataType:"json",cache:!1,complete:function(){o(t,"request",!1),n.onRequestComplete&&n.onRequestComplete()},success:function(e){o(t,"value",e.progress.num),o(t,"max",e.progress.total),e.started_at&&o(t,"text",e.progress.message),s(t),(e.succeeded||e.failed)&&(i(t),e.succeeded&&n.onSuccess&&n.onSuccess(e),e.failed&&n.onError&&n.onError(e)),n.onRequestSuccess&&n.onRequestSuccess(e)},error:function(e){i(t),n.onRequestError&&n.onRequestError(e)}})},u=function(n){n.each(function(){var n=e(this).data("options",e.extend({},t)),o=r(n);n.addClass(o.classProgressBarContainer).show().html(o.text),!o.disabled&&a(n)})},l={init:function(r){return t={},e.extend(t,n,r),u(this),this},disable:function(){return i(this),this},enable:function(){return a(this),this},option:function(){return r(this)},value:function(e){if(e===undefined)return r(this).value;o(this,"value",e),s(this)},text:function(e){if(e===undefined)return r(this).text;o(this,"text",e),s(this)}};e.fn.progressBar=function(t){return"object"!=typeof t&&t?l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):void e.error("\u041c\u0435\u0442\u043e\u0434 "+t+" \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 jQuery.progressBar"):l.init.apply(this,arguments)}}(jQuery),function(e){function t(e){throw RangeError(P[e])}function n(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function r(e,t){return n(e.split(_),t).join(".")}function o(e){for(var t,n,r=[],o=0,a=e.length;o<a;)t=e.charCodeAt(o++),55296==(63488&t)&&o<a?(n=e.charCodeAt(o++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):r.push(t,n)):r.push(t);return r}function a(e){return n(e,function(e){var t="";return e>65535&&(e-=65536,t+=O(e>>>10&1023|55296),e=56320|1023&e),t+=O(e)}).join("")}function i(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:y}function s(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function c(e,t,n){var r=0;for(e=n?E(e/C):e>>1,e+=E(e/t);e>I*k>>1;r+=y)e=E(e/I);return E(r+(I+1)*e/(e+w))}function u(e){var n,r,o,s,u,l,d,p,f,g,h=[],m=e.length,b=0,w=S,C=j;for(r=e.lastIndexOf($),r<0&&(r=0),o=0;o<r;++o)e.charCodeAt(o)>=128&&t("not-basic"),h.push(e.charCodeAt(o));for(s=r>0?r+1:0;s<m;){for(u=b,l=1,d=y;s>=m&&t("invalid-input"),p=i(e.charCodeAt(s++)),(p>=y||p>E((v-b)/l))&&t("overflow"),b+=p*l,f=d<=C?x:d>=C+k?k:d-C,!(p<f);d+=y)g=y-f,l>E(v/g)&&t("overflow"),l*=g;n=h.length+1,C=c(b-u,n,0==u),E(b/n)>v-w&&t("overflow"),w+=E(b/n),b%=n,h.splice(b++,0,w)}return a(h)}function l(e){var n,r,a,i,u,l,d,p,f,g,h,m,b,w,C,R=[];for(e=o(e),m=e.length,n=S,r=0,u=j,l=0;l<m;++l)(h=e[l])<128&&R.push(O(h));for(a=i=R.length,i&&R.push($);a<m;){for(d=v,l=0;l<m;++l)(h=e[l])>=n&&h<d&&(d=h);for(b=a+1,d-n>E((v-r)/b)&&t("overflow"),r+=(d-n)*b,n=d,l=0;l<m;++l)if(h=e[l],h<n&&++r>v&&t("overflow"),h==n){for(p=r,f=y;g=f<=u?x:f>=u+k?k:f-u,!(p<g);f+=y)C=p-g,w=y-g,R.push(O(s(g+C%w,0))),p=E(C/w);R.push(O(s(p,0))),u=c(r,b,a==i),r=0,++a}++r,++n}return R.join("")}function d(e){return r(e,function(e){return R.test(e)?u(e.slice(4).toLowerCase()):e})}function p(e){return r(e,function(e){return L.test(e)?"xn--"+l(e):e})}var f="object"==typeof exports&&exports,g="object"==typeof module&&module&&module.exports==f&&module,h="object"==typeof global&&global;h.global!==h&&h.window!==h||(e=h);var m,b,v=2147483647,y=36,x=1,k=26,w=38,C=700,j=72,S=128,$="-",R=/^xn--/,L=/[^ -~]/,_=/\x2E|\u3002|\uFF0E|\uFF61/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=y-x,E=Math.floor,O=String.fromCharCode;if(m={version:"1.2.1",ucs2:{decode:o,encode:a},decode:u,encode:l,toASCII:p,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return m});else if(f&&!f.nodeType)if(g)g.exports=m;else for(b in m)m.hasOwnProperty(b)&&(f[b]=m[b]);else e.punycode=m}(this),function(e){function t(t,n){var r=n.split(""),o=-1;return e.each(t,function(t,n){return-1===(o=e.inArray(n,r))}),o}e.fn.numeric=function(t,n){"boolean"==typeof t&&(t={decimal:t,negative:!0,decimalPlaces:-1,integerPlaces:-1}),t=t||{},"undefined"==typeof t.negative&&(t.negative=!0);var r;r=!1===t.decimal?[]:t.decimal&&!0!==t.decimal?e.isArray(t.decimal)?t.decimal:[t.decimal]:["."];var o=!0===t.negative,a="undefined"==typeof t.decimalPlaces?-1:t.decimalPlaces,i="undefined"==typeof t.integerPlaces?-1:t.integerPlaces;return n="function"==typeof n?n:function(){},this.data("numeric.decimal",r).data("numeric.negative",o).data("numeric.callback",n).data("numeric.decimalPlaces",a).data("numeric.integerPlaces",i).keypress(e.fn.numeric.keypress).keyup(e.fn.numeric.keyup).blur(e.fn.numeric.blur)},e.fn.numeric.keypress=function(n){var r=e.data(this,"numeric.decimal"),o=e.data(this,"numeric.negative"),a=e.data(this,"numeric.decimalPlaces"),i=e.data(this,"numeric.integerPlaces"),s=n.charCode?n.charCode:n.keyCode?n.keyCode:0,c=e(this).val();if(13==s&&"input"==this.nodeName.toLowerCase())return!0;if(13==s)return!1;var u=!1;if(n.ctrlKey&&97==s||n.ctrlKey&&65==s)return!0;if(n.ctrlKey&&120==s||n.ctrlKey&&88==s)return!0;if(n.ctrlKey&&99==s||n.ctrlKey&&67==s)return!0;if(n.ctrlKey&&122==s||n.ctrlKey&&90==s)return!0;if(n.ctrlKey&&118==s||n.ctrlKey&&86==s||n.shiftKey&&45==s)return!0;if(s<48||s>57){if(0!==e.inArray("-",c.split(""))&&o&&45==s&&(0===c.length||0===parseInt(e.fn.getSelectionStart(this),10)))return!0;8!=s&&9!=s&&13!=s&&35!=s&&36!=s&&37!=s&&39!=s&&46!=s?u=!1:"undefined"!=typeof n.charCode&&(n.keyCode==n.which&&0!==n.which?(u=!0,46==n.which&&(u=!1)):0!==n.keyCode&&0===n.charCode&&0===n.which&&(u=!0)),-1!==e.inArray(String.fromCharCode(s),r)&&(u=-1===t(r,c))}else{var l=t(r,c),d=e.fn.getSelectionStart(this);u=!0,a>0&&-1!==l&&d>l&&c.length>l+a&&(u=!1),i>=0&&(-1===l&&c.length+1>i||-1!==l&&d<=l&&l+1>i)&&(u=!1)}return u},e.fn.numeric.keyup=function(){var n=e(this).val();if(n&&n.length>0){var r=e.fn.getSelectionStart(this),o=e.fn.getSelectionEnd(this),a=e.data(this,"numeric.decimal"),i=e.data(this,"numeric.negative"),s=e.data(this,"numeric.decimalPlaces"),c=e.data(this,"numeric.integerPlaces");if(a.length){var u=t(a,n);0===u&&(this.value="0"+n,r++,o++),1==u&&"-"==n.charAt(0)&&(this.value="-0"+n.substring(1),r++,o++),n=this.value}for(var l=[0,1,2,3,4,5,6,7,8,9,"-"].concat(a),d=n.length,p=d-1;p>=0;p--){var f=n.charAt(p);0!==p&&"-"==f?n=n.substring(0,p)+n.substring(p+1):0!==p||i||"-"!=f||(n=n.substring(1));for(var g=!1,h=0;h<l.length;h++)if(f==l[h]){g=!0;break}g&&" "!=f||(n=n.substring(0,p)+n.substring(p+1))}var m=t(a,n);if(m>0)for(var b=d-1;b>m;b--){var v=n.charAt(b);-1!==e.inArray(v,a)&&(n=n.substring(0,b)+n.substring(b+1))}if(a.length&&s>0){var u=t(a,n);u>=0&&(n=n.substring(0,u+s+1),o=Math.min(n.length,o))}if(c>=0){var u=t(a,n);if(-1===u)n=n.substring(0,c),o=Math.min(n.length,o);else{var y=n.substring(0,u),x=n.substring(u);y=y.substring(0,c),n=y+x}}this.value=n,e.fn.setSelection(this,[r,o])}},e.fn.numeric.blur=function(){var t=e.data(this,"numeric.decimal"),n=e.data(this,"numeric.callback"),r=e.data(this,"numeric.negative"),o=this.value,a="";if(e.each(t,function(e,t){a+="\\"+t}),a&&(a="["+a+"]"),""!==o){new RegExp(r?"-?":"^\\d+$|^\\d*"+a+"\\d+$").exec(o)||n.apply(this)}},e.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).data("numeric.decimalPlaces",null).data("numeric.integerPlaces",null).unbind("keypress",e.fn.numeric.keypress).unbind("keyup",e.fn.numeric.keyup).unbind("blur",e.fn.numeric.blur)},e.fn.getSelectionStart=function(e){if("number"===e.type)return undefined;if(e.createTextRange&&document.selection){var t=document.selection.createRange().duplicate();return t.moveEnd("character",e.value.length),""==t.text?e.value.length:Math.max(0,e.value.lastIndexOf(t.text))}try{return e.selectionStart}catch(e){return 0}},e.fn.getSelectionEnd=function(e){if("number"===e.type)return undefined;if(e.createTextRange&&document.selection){var t=document.selection.createRange().duplicate();return t.moveStart("character",-e.value.length),t.text.length}return e.selectionEnd},e.fn.setSelection=function(e,t){if("number"==typeof t&&(t=[t,t]),t&&t.constructor==Array&&2==t.length)if("number"===e.type)e.focus();else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveStart("character",t[0]),n.moveEnd("character",t[1]-t[0]),n.select()}else{e.focus();try{e.setSelectionRange&&e.setSelectionRange(t[0],t[1])}catch(e){}}}}(jQuery);var ShowAttentionPopup=function(e){var t,n={$form:null,text:"",html:""},r=function(){t=e("<div>").addClass("save-your-changes-popup js-save-your-changes-popup").append(n.text?e("<p>").addClass("sycp-text").text(n.text):n.html,e("<button>").addClass("sycp-button js-yes-button").text("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),e("<span>").addClass("sycp-connector").text("\u0438\u043b\u0438"),e("<a>").attr("href","#").addClass("js-no-button").text("\u0443\u0439\u0442\u0438 \u0431\u0435\u0437 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f")).hide()},o=function(){$doc.on("showAttentionPopup",function(n,r){e("body").append(t.data("href",r)),openStaticPopup("js-save-your-changes-popup")})},a=function(){$doc.on("click",".js-yes-button",function(){n.$form.attr("action",n.$form.attr("action")+"?return_to="+t.data("href")).trigger("submit")}),$doc.on("click",".js-no-button",function(e){e.preventDefault(),location.href=t.data("href")})},i=function(){r(),o(),a()};return{init:function(t){e.extend(n,t),i()}}}(jQuery);app.modules.showCompanyAddress=function(e){function t(){$doc.on("click",".js-show-company-address, .js-company-location-show-address",function(){$(".js-show-company-address, .js-address-content").toggle(),$.cookie("show_address_"+$(this).data("company-id"),1,{path:"/"})})}return e.load=function(){t()},e}(app.modules.showCompanyAddress||{}),app.modules.googleConversion=function(e){return e.load=function(){window.google_trackConversion&&window.google_trackConversion({google_conversion_id:836150059,google_custom_params:window.google_tag_params,google_remarketing_only:!0})},e}(app.modules.googleConversion||{}),function(e,t){"$:nomunge";var n,r=e.jQuery||e.Cowboy||(e.Cowboy={});r.throttle=n=function(e,n,o,a){function i(){function r(){c=+new Date,o.apply(u,d)}function i(){s=t}var u=this,l=+new Date-c,d=arguments;a&&!s&&r(),s&&clearTimeout(s),a===t&&l>e?r():!0!==n&&(s=setTimeout(a?i:r,a===t?e-l:e))}var s,c=0;return"boolean"!=typeof n&&(a=o,o=n,n=t),r.guid&&(i.guid=o.guid=o.guid||r.guid++),i},r.debounce=function(e,r,o){return o===t?n(e,r,!1):n(e,o,!1!==r)}}(this),function(e){var t={init:function(t){return this.each(function(){var n,r=e(this),o=e.extend({},e.fn.checkLength.defaults,t),a=r.data("counter"),i=r.attr("maxlength")||o.maxLength,s=r.data("lower-bound")||o.lowerBound,c=r.data("count-method")||o.countMethod,u=r.data("counter-text")||o.counterText,l=r.data("counter-id");a||(l?a=e("#"+l):(n=e("<span>").addClass(o.counterClassName).text(u).insertAfter(r),a=e("<b>").appendTo(n)),r.data("counter",a).on("keydown keyup paste focusout",function(){var e,t=r.val(),n=s||i/4;t.length>i&&(t=t.substring(0,i),r.val(t)),e="down"===c?i-t.length:t.length,a.html(e<=n?"<span>"+e+"</span>":e)})),r.keyup()}),this}};e.fn.checkLength=function(n){return n&&"object"!=typeof n?t[n]?t[n].apply(this,Array.prototype.slice.call(arguments,1)):void e.error(n+" is not a method of jQuery.checkLength"):t.init.apply(this,arguments)},e.fn.checkLength.defaults={counterClassName:"uf-c counter-",counterText:"\u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432: ",countMethod:"down",maxlength:255}}(jQuery),app.modules.messengersDeeplink=function(e){function t(e,t,n){var r={telegram:app.config.messengers.telegramURL,viber:app.config.messengers.viberURL};c||(c=!0,u=!1,window.location.href=r[e],setTimeout(function(){c=!1,u||n(e,t)},d))}function n(e){var t=o();t!==p&&(window.location.href=l[t][e])}function r(e,t){$.post(app.config.messengers.notificationURL,{messenger:e,phone:t})}function o(){if(s!==undefined)return s;var e,t={iOS:/iPhone|iPad|iPod/i,android:/Android/i,windows:/Windows\s+Phone|IEMobile/i};s=p;for(e in t)navigator.userAgent.match(t[e])&&(s=e);return s}function a(){u=!0}function i(){window.addEventListener("blur",a),$doc.on("click",".js-messenger-link",function(){var e=$(this).data();t(e.app,e.phone,app.config.isMobile?n:r)})}var s,c,u,l={iOS:{telegram:"itms-apps://itunes.apple.com/app/telegram-messenger/id686449807?mt=8",viber:"itms-apps://itunes.apple.com/app/viber-messenger/id382617920?mt=8"},android:{telegram:"market://details?id=org.telegram.messenger",viber:"market://details?id=com.viber.voip"},windows:{telegram:"zune:navigate?appid=9wzdncrfj46z",viber:"zune:navigate?appid=9wzdncrdzhs0"}},d=1e3,p="unknown";return e.load=function(){i()},e}(app.modules.messengersDeeplink||{});